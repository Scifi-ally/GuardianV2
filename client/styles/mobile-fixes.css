/* Mobile-Specific Fixes and Optimizations for Guardian Safety App */

/* ============================================
   SAFE AREA HANDLING - iOS Notch & Android
   ============================================ */

/* Safe area support for modern devices */
:root {
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
}

/* Safe area utility classes */
.safe-area-inset-top {
  padding-top: calc(0.75rem + var(--safe-area-inset-top));
}

.safe-area-inset-bottom {
  padding-bottom: calc(0.75rem + var(--safe-area-inset-bottom));
}

.safe-area-inset-left {
  padding-left: calc(0.75rem + var(--safe-area-inset-left));
}

.safe-area-inset-right {
  padding-right: calc(0.75rem + var(--safe-area-inset-right));
}

.safe-area-full {
  padding-top: var(--safe-area-inset-top);
  padding-right: var(--safe-area-inset-right);
  padding-bottom: var(--safe-area-inset-bottom);
  padding-left: var(--safe-area-inset-left);
}

/* ============================================
   TOUCH OPTIMIZATION
   ============================================ */

/* Improve touch targets for emergency buttons */
.touch-emergency {
  min-height: 44px;
  min-width: 44px;
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Better touch response for interactive elements */
.touch-optimization {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  cursor: pointer;
}

/* Emergency SOS button special handling */
.sos-button {
  min-height: 60px;
  min-width: 60px;
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  position: relative;
  z-index: 10;
}

/* ============================================
   VIEWPORT FIXES
   ============================================ */

/* Prevent zooming on input focus (iOS Safari) */
input[type="text"],
input[type="email"],
input[type="tel"],
input[type="password"],
textarea,
select {
  font-size: 16px !important;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

/* Fix viewport height issues on mobile browsers */
.full-screen-mobile {
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
  min-height: 100vh;
  min-height: 100dvh;
}

/* Small viewport height optimizations */
@media screen and (max-height: 640px) {
  .compact-on-small {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }

  .text-compact-small {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }

  .space-compact-small > * + * {
    margin-top: 0.5rem;
  }
}

/* Very small devices (iPhone SE, etc.) */
@media screen and (max-width: 375px) {
  .text-xs-mobile {
    font-size: 0.75rem;
  }

  .p-xs-mobile {
    padding: 0.5rem;
  }

  .gap-xs-mobile {
    gap: 0.25rem;
  }
}

/* ============================================
   EMERGENCY MODE STYLING
   ============================================ */

/* High contrast mode for emergency situations */
.emergency-mode {
  --emergency-red: #dc2626;
  --emergency-red-dark: #991b1b;
  --emergency-green: #16a34a;
  --emergency-yellow: #ca8a04;
  --emergency-white: #ffffff;
  --emergency-black: #000000;
}

.emergency-mode .emergency-button {
  background-color: var(--emergency-red) !important;
  color: var(--emergency-white) !important;
  border: 2px solid var(--emergency-red-dark) !important;
  font-weight: bold !important;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;
}

.emergency-mode .emergency-button:hover,
.emergency-mode .emergency-button:focus {
  background-color: var(--emergency-red-dark) !important;
  transform: scale(1.05) !important;
}

/* ============================================
   BATTERY OPTIMIZATION
   ============================================ */

/* Reduced motion for battery saving */
@media (prefers-reduced-motion: reduce) {
  .battery-save * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Dark mode optimizations for OLED screens */
@media (prefers-color-scheme: dark) {
  .oled-dark {
    background-color: #000000 !important;
    color: #ffffff !important;
  }
}

/* ============================================
   ACCESSIBILITY IMPROVEMENTS
   ============================================ */

/* High contrast focus indicators */
.focus-emergency:focus,
.focus-emergency:focus-visible {
  outline: 4px solid #ff0000 !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 8px rgba(255, 0, 0, 0.3) !important;
}

/* Better text selection for emergency info */
.select-all {
  -webkit-user-select: all;
  -moz-user-select: all;
  user-select: all;
}

/* Emergency announcements for screen readers */
.sr-emergency {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-emergency.active {
  position: static;
  width: auto;
  height: auto;
  padding: 0.5rem;
  margin: 0.5rem;
  overflow: visible;
  clip: auto;
  white-space: normal;
  background-color: #fee2e2;
  border: 2px solid #dc2626;
  color: #7f1d1d;
  font-weight: bold;
}

/* ============================================
   PERFORMANCE OPTIMIZATIONS
   ============================================ */

/* GPU acceleration for smooth animations */
.gpu-accelerated {
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Optimize scrolling performance */
.smooth-scroll {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* ============================================
   LANDSCAPE MODE ADJUSTMENTS
   ============================================ */

@media screen and (orientation: landscape) and (max-height: 500px) {
  /* Compact header in landscape */
  .landscape-compact-header {
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
  }

  /* Reduce vertical spacing */
  .landscape-compact-space > * + * {
    margin-top: 0.25rem;
  }

  /* Smaller text in landscape */
  .landscape-compact-text {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }
}

/* ============================================
   PWA SPECIFIC FIXES
   ============================================ */

/* iOS PWA status bar fixes */
@media all and (display-mode: standalone) {
  .pwa-status-bar-fix {
    padding-top: calc(var(--safe-area-inset-top) + 0.5rem);
  }
}

/* Android PWA navigation fixes */
@media all and (display-mode: standalone) and (orientation: portrait) {
  .pwa-navigation-fix {
    padding-bottom: calc(var(--safe-area-inset-bottom) + 1rem);
  }
}

/* ============================================
   EXTREME DEVICE SUPPORT
   ============================================ */

/* Ultra-wide screens */
@media screen and (min-aspect-ratio: 21/9) {
  .ultrawide-padding {
    padding-left: 10vw;
    padding-right: 10vw;
  }
}

/* Foldable device support */
@media screen and (spanning: single-fold-vertical) {
  .foldable-split {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }
}

/* Very small screens (smartwatches, etc.) */
@media screen and (max-width: 280px) {
  .micro-device {
    font-size: 0.625rem;
    padding: 0.25rem;
  }

  .micro-device .button {
    min-height: 32px;
    font-size: 0.625rem;
    padding: 0.25rem 0.5rem;
  }
}

/* ============================================
   CRITICAL EMERGENCY OVERRIDES
   ============================================ */

/* Force visibility for emergency elements */
.emergency-critical {
  position: relative !important;
  z-index: 9999 !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: block !important;
}

/* Emergency text that must be readable */
.emergency-text-critical {
  color: #000000 !important;
  background-color: #ffffff !important;
  padding: 0.5rem !important;
  border: 2px solid #dc2626 !important;
  font-weight: bold !important;
  font-size: 1rem !important;
  line-height: 1.5 !important;
}

/* Lock scroll during emergency mode */
.emergency-scroll-lock {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
}

/* ============================================
   UTILITY CLASSES FOR COMMON MOBILE ISSUES
   ============================================ */

/* Fix content shift on keyboard open */
.keyboard-stable {
  height: 100vh;
  height: 100dvh;
  overflow: hidden;
}

/* Prevent bounce scrolling */
.no-bounce {
  overscroll-behavior: none;
}

/* Hide scrollbars but keep functionality */
.hide-scrollbar {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.hide-scrollbar::-webkit-scrollbar {
  display: none;
}

/* One-handed mode optimizations */
.one-handed-bottom {
  position: sticky;
  bottom: 0;
  z-index: 50;
}

/* Reduce motion for motion-sensitive users */
@media (prefers-reduced-motion: reduce) {
  .motion-safe-only {
    animation: none !important;
    transition: none !important;
  }
}
